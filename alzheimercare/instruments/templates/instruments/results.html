{% extends 'base.html' %}


{% block content %}
<div class="row">
    <div class="col-sm-12">
        <div class="ibox">
            <div class="ibox-title">
                <h5>Resultados</h5>
            </div>
            <div class="ibox-content">
                <form method="post">
                    {% csrf_token %}
                    {{ form.management_form }}
                    <div class="row">
                        <div class="col-sm-5">
                            <label>Cuidadores</label>
                        </div>
                        <div class="col-sm-5">
                            <label>Valoraciones</label>
                        </div>
                        <div class="col-sm-5">
                            {{form.caregivers}}
                        </div>
                        <div class="col-sm-5">
                            {{form.valorations}}
                        </div>
                        <div class="col-sm-2">
                            <button type="submit" class="btn btn-primary text-right">Filtrar</button>
                        </div>
                    </div>
                </form>
                <hr class="hr-dashed">
                {% if results_list %}
                    <div class="table-responsive">
                        <table class="table table-striped dataTables">
                            <thead>
                                <tr>
                                    <th>Valoracion</th>
                                    <th>Cuidador</th>
                                    <th>Instrumento</th>
                                    <th>Fecha de realización</th>
                                    <th>Puntaje</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for result in results_list %}
                                    <tr>
                                        <td>{{result.valoration.name}}</td>
                                        <td>{{result.user.first_name}}&nbsp;{{result.user.last_name}}</td>
                                        <td>{{result.instrument.name}}</td>
                                        <td>{{result.answer_date}}</td>
                                        <td>{{result.get_score}}</td>
                                        <td class="fa-icons">
                                            <a href="{% url 'detail_result' result.pk%}" data-toggle="tooltip" title="Ver resultados"><i class="fa fa-eye fa-lg text-muted"></i> </a>
                                            <a href="{% url 'create_report' result.pk%}" data-toggle="tooltip" title="Generar reporte"><i class="fa fa-file fa-lg text-primary"></i> </a>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <nav aria-label="Page navigation example">
                        <ul class="pagination">
                            {% if results_list.has_previous %}
                                <li class="page-item"><a href="?page={{results_list.previous_page_number }}">Anterior</a></li>
                            {% else %}
                                <li class="page-item disabled"><a href="">Anterior</a></li>
                            {% endif %}
                            <li class="page-item"><a class="page-link" href="#">{{ results_list.number }}</a></li>
                            {% if results_list.has_next %}
                                <li class="page-item"><a href="?page={{ results_list.next_page_number }}">Siguiente</a></li>
                            {% else %}
                                <li class="page-item disabled"><a href="">Siguiente</a></li>
                            {% endif %}
                            
                        </ul>
                    </nav>

                {% else %}
                    <p>Aún no hay resultados</p>
                {% endif %}
                <hr class="hr-dashed">
                <a href="{% url 'index' %}" class="btn btn-white">Regresar</a>
            </div>
        </div>
    </div>
</div>
    
{% endblock content %}

    
    